from typing import List
from solution import solve
import random


# brute force
def solve2(a: List[int]) -> int:
    N = len(a)

    accum_sum = [0 for _ in range(N+1)]

    for i, item in enumerate(a):
        accum_sum[i+1] = item + accum_sum[i]

    for k in range(1, N+1):
        l = 0; r = k
        while r <= N:
            if accum_sum[r] - accum_sum[l] <= 0:
                break
            l += 1; r += 1
        else:
            return k

    return -1


def check(a: List[int], k) -> int:
    N = len(a)

    accum_sum = [0 for _ in range(N+1)]

    for i, item in enumerate(a):
        accum_sum[i+1] = item + accum_sum[i]

    l = 0; r = k
    while r <= N:
        if accum_sum[r] - accum_sum[l] <= 0:
            break
        l += 1; r += 1
    else:
        return k

    return -1


def tester(amount_tests: int, max_size: int):
    
    for _ in range(amount_tests):
        
        size = random.randint(1, max_size)
        
        a = []
        for _ in range(size):
            a.append(random.randint(-2**8, 2**8))
        t = 0
        while t == 0: t = random.randint(-2**8, 2**8)
        a += [t] * size

        k = solve(a)

        try:
            if k > 0:
                assert check(a, k)
            else:
                assert solve2(a) == k == -1
        except:
            print(f'k={k} is not solution of:\n{a}\n')


if __name__ == '__main__':
    AMOUNT_OF_TEST_CASES = 1_000_000
    SIZE_OF_ARRAY = 1000
    
    tester(
        amount_tests=AMOUNT_OF_TEST_CASES,
        max_size=SIZE_OF_ARRAY
    )

    # a = [-4152766843, -3623582965, -3891764445, -591225052, -184076382, 3343976800, 2563849605, 358644989, -1939619579, -1427620879, 3141875495, -3459852771, -1651516366, -3335244894, 1264039026, 60934916, -2756800040, 2830992954, 73756963, -4007431590, -2814539661, 935975033, 68210183, -2132686898, -3164552020, 111970807, -1588732593, -817378370, 3012845440, -906501831, -3674358145, -680099553, 4030159905, 683371107, -1792866647, -3721105114, 1929716061, -2683803703, 2242388993, -2907117167, 2790441696, -1303343, -3171800793, -3547123904, 2442472962, -2756363081, 1897094938, 3864188149, 4262913876, 2566349913, -2749568551, -3417762265, 3554366457, 3431159194, 927305259, -1680394628, 3057261879, -3551405780, -1302287992, -2844607577, -1368432171, -3240800315, 4058478204, -1245777685, 939430087, 928116947, -3838772784, 2250870794, 3082392512, 3897541300, -885743597, 3198709056, 2620633545, 3371117070, 3249857711, 3880978018, -1002991800, -4055657058, -1713935518, -4248664994, -1983178183, 972091967, 2182434162, 2317367508, 1056202622, -466971319, 806620846, -401857843, 1631363230, -1465865234, -4154889790, 365429261, 2560419636, 1599951390, -1003438685, 1931313862, 2751439252, -3916057687, -340689522, -4130067573, 2681655193, -2952488412, -1041034468, 3971597423, 3220971040, -2967292853, -584519259, -359987425, -2176324754, -1810969758, 3168404917, 3629978045, 2839190651, -1224056737, -223144373, -3632581035, -1983490351, -2157055138, -2010660913, 3694587609, -4086353783, -2972321687, 101114664, 2581511789, 4135624507, 3069677065, 3940061595, -1190157162, 3977389881, 3665825083, -3238874204, -1944984650, 3468998634, 23483484, 25046809, 2522652937, -347830518, 1342454816, -652256069, 4118970761, 4281963435, 4010432967, -2209066616, 3363767856, -3741906135, 3377366409, -424461814, 949592839, -2631809641, 2004136021, 2375899412, -448095656, -1053150573, -1159629330, -936316285, -4126289803, 1972962190, -1676777764, -3649695632, -2011592788, -3070131379, 4221872172, 859682242, 3322713100, 1596351259, 3885590594, -811268576, -3316885893, -1067009390, -968447071, -1307046494, -2958296933, -2798201603, 543758990, 1015592984, -2600595908, 2924713476, -151415859, -863443056, -1225027781, -2934870990, 3333753548, -1503591449, -3095525039, 2063455927, 81095053, 4279742738, 1769746128, -863759676, 1383651408, 3592814886, -104758380, -778646164, 1238364613, -2444980599, -3236304971, -3452120992, -679523046, -3957467702, 3831655252, -3665997623, -2897285169, 3326109295, -339066948, 763441016, 1493780034, 2436275332, -2606086402, 2890324165, -4155776472, 3109332782, 2930324051, -180008490, 2122411885, 1961366735, 2911035633, 75842011, 79673168, 2659171607, 3553377662, -190391214, -3798510112, 2236676588, 3027393688, -81899723, -1206162238, -1730765477, -3730185252, 3855467390, -2408782728, -294322311, 199447694, 3702511266, -3733306562, 2947172529, 961830735, -869683515, 2413241545, -3508932090, 1198708579, -2861520188, -729024854, -709482009, 750711479, 2976756604, -876736226, 1350796430, -1560897650, -3027118022, 1141700247, -1829116014, -3492694952, 2873234789, -4280679645, -3073351256, -516201525, -2019907881, -436044531, 855127944, 2080099913, 3747050929, 3683798257, 3744861651, -1768911459, 4009077119, -153304203, 1685358751, -4260383195, 2575029106, -1205555999, 2140251358, -2106711831, -505246193, 1579896319, 1386927408, -248462031, 3912509919, -993471926, -3313493665, -2513399313, -1891233608, 3912201084, -3939467252, -2210766425, -1202158618, 856620861, 2560705170, -2754368934, -851899282, -3362764118, 1170718446, -3111353760, 269647499, 1214343515, -1701132625, 3036658232, 4106208383, -487685831, 1573393441, -576395883, -3023728803, -786868769, 3685332593, -2724152040, 1554599754, -4076842599, 2671773894, -1320046379, -1093216947, -3962557136, 3692512552, 716531681, 840213491, 3011424894, -1608775631, 4251237037, 244276876, 1661214818, -2567594395, -1107930907, 2311590489, -73149073, 1916687350, 1697848831, -2873405654, -522232414, -1283649689, -140658846, -501408866, 2406430671, 2620883923, 3861818965, -3522235492, 3272629898, -1787250960, 1453508317, -884091038, 1189045311, -4151637730, -1552095751, 169122315, 3787647891, -2761914326, -2180615829, 845586986, 2977781851, 226500171, -466583593, 3057144542, -311158947, 1944720265, 2234086525, 305840808, 3431222814, -1594953809, -174254073, -2331277123, -381286938, 230090217, -340967197, -4207567668, -3088543208, 1477556099, 426627869, 2960212026, 30216834, -2698446022, 1492874, 1759134013, -2618521946, -407522011, -1463773991, -1652305326, 3160975938, 170065267, 2566498475, -328414012, 115704200, -3302882536, 2247840520, 2485401493, -2036486464, 3822131630, -1929901231, 1918024719, 312649014, -2006006121, -3018459171, -1393168436, 1028188694, 1249467832, 3168309698, -287482790, -3847516919, -1894565446, -2231370114, -1204869497, -3918004215, 1595033702, -2103683711, 1556066575, 2239258145, -2320279454, 155304799, 3399393671, 1813466264, 3818060518, 3563857952, -3903286310, 2578606388, -2477395043, 2498793243, 3023194303, -3286626906, 270191784, 308131279, 644344058, -4171884882, 842602085, 652658878, 2213068337, -103825420, -3536537993, 788099360, 1248774482, 1534237551, -2177817070, -3116024230, 1919840968, 936591098, -1354996641, -4012234738, 3472333978, 202501805, 3377663629, 2348191966, 2660636267, -3366043792, -1075921023, 643611430, -303340444, 118900883, 1334595582, -738913473, -500456393, -84230875, -3109481068, -2064530979, -3555999468, 2806121938, -563399464, -669909909, 57459347, 1619129385, 3831917060, 1730354059, 327458281, -1313249097, 3848481468, -2832733167, -692106569, -151220180, 3006112279, -1482479715, 3048257009, -173936929, -325026309, 94880336, -2188512637, -622919045, 3991888136, 473754693, -3162655115, 306505413, -1911545773, 1713057076, 2722559816, 1387007886, 3114264138, -2176154697, 3267918310, -1587816115, -817049942, 3869672683, -2202278500, -640573823, 3692395414, 752231337, 795059570, 386605696, 2068863319, 2292277687, 339997221, -3217635668, 582323204, -2578437486, 1905339224, -2135217447, -3797028842, -3178277704, 3022226176, 512464293, -148823243, 3981818948, -1056633171, 1557515280, 291630150, 3912066343, 4155991810, -3344124193, -2259687291, 2310032158, 852281139, 2794559942, 575261986, 2364822725, -5984729, -2377970510, 1403876989, 3525356761, 1934514187, 1801741679, 2649551541, 2414989446, -3281004559, 1484774044, -3200988712, 3840439681, 1260703197, 1900139073, 3323389936, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341, -119856341]
    
    # k = solve2(a)
    # print(solve(a), k)
    # assert check(a, k)