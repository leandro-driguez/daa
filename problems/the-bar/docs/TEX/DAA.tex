\documentclass[10pt]{amsart}

% Package Being Used:

\usepackage[utf8]{inputenc}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{bm}
\usepackage{graphicx}
\usepackage{psfrag}
\usepackage{color}
\usepackage{hyperref}
\hypersetup{colorlinks=true, linkcolor=blue, citecolor=magenta, urlcolor=wine}
\usepackage{url}
\usepackage{algpseudocode}
\usepackage{fancyhdr}
\usepackage{mathtools}
\usepackage{tikz-cd}
\usepackage{xy}
\input xy
\xyoption{all}
\usepackage{stmaryrd}
\usepackage{calrsfs}

% Paper Format and Geometry:

\voffset=-1.4mm
\oddsidemargin=14pt
\evensidemargin=14pt
\topmargin=26pt
\headheight=9pt     
\textheight=576pt
\textwidth=441pt %441
\parskip=0pt plus 4pt

% Head Labels:

\pagestyle{fancy}
\fancyhf{}
\renewcommand{\headrulewidth}{0pt}
\renewcommand{\footrulewidth}{0pt}
\fancyhead[CE]{\fontsize{9}{11}\selectfont L. RODR\'IGUEZ Y  M. M. TIRADOR }
\fancyhead[CO]{\fontsize{9}{11}\selectfont EL BAR}
\fancyhead[LE,RO]{\thepage}

\setlength{\headheight}{9pt}

% Theorems-like Format and Numbering:

\newtheorem*{maintheorem*}{Main Theorem}
\newtheorem{theorem}{Theorem}[section]
\newtheorem{prop}[theorem]{Proposici\'on}
\newtheorem{conj}[theorem]{Conjecture}
\newtheorem{lem}[theorem]{Lema}
\newtheorem{cor}[theorem]{Corollary}
\newtheorem{teo}[theorem]{Teorema}

\theoremstyle{definition}
\newtheorem{defn}[theorem]{Definition}
\newtheorem{rem}[theorem]{Remark}
\newtheorem{example}[theorem]{Example}
\newtheorem{sol}[theorem]{Soluci\'on}
\newtheorem{prob}[theorem]{Problema}
%\newtheorem{prob}[theorem]{Problem}
\newtheorem{question}[theorem]{Question}
\numberwithin{equation}{section}

% Personalized Commands:
\newcommand{\cc}{\mathbb{C}}
\newcommand{\ff}{\mathbb{F}}
\newcommand{\nn}{\mathbb{N}}
\newcommand{\pp}{\mathbb{P}}
\newcommand{\ppp}{\mathcal{P}}
\newcommand{\qq}{\mathbb{Q}}
\newcommand{\rr}{\mathbb{R}}
\newcommand{\zz}{\mathbb{Z}}

\newcommand{\ch}{\text{char}}
\newcommand{\lcm}{\text{lcm}}
\providecommand\ldb{\llbracket}
\providecommand\rdb{\rrbracket}
\newcommand\pval{\mathsf{v}_p}
\newcommand{\gp}{\text{gp}}
\newcommand{\qf}{\text{qf}}
\newcommand{\supp}{\textsf{supp}}
\newcommand{\ii}{\mathcal{Irr}}
\newcommand{\uu}{\mathcal{U}}
\newcommand{\ppf}{\mathcal{P}_{\text{fin}}}
\newcommand{\ppx}{\mathcal{P}_{\text{fin}, 0}} 
%\newcommand{\ppx}{\mathcal{P}_{\emph{fin}, \times}} % Do not use this notation
\newcommand{\inter}{\mathsf{int}}
\newcommand{\cone}{\mathsf{cone}}
\newcommand{\norm}[1]{\left\lVert#1\right\rVert}

\newcommand{\at}{\mathcal{A}}
\newcommand{\lf}{\lfoloor}
\newcommand{\fl}[1]{\lfloor#1\rfloor}
\newcommand{\cl}[1]{\lceil #1\rceil}
\newcommand{\ds}{\displaystyle}

\keywords{Minkowski sum, power monoid, Puiseux monoid, atomicity, factorization theory}

%\subjclass[2010]{Primary: 13C05, 13A15, 13C13; Secondary: 13A15}

\begin{document}
	
	\mbox{}
	\title{El Bar}
	
	\author{Marcos M. Tirador}
	\address{Facultad de Matem\'atica y Computaci\'on \\ Universidad de La Habana \\ Ciudad de La Habana \\ Cuba}
	\email{marcosmath44@gmail.com}
	
	
	\author{Leandro Rodr\'iguez Llosa}
	\address{Facultad de Matem\'atica y Computaci\'on \\ Universidad de La Habana \\ Ciudad de La Habana \\ Cuba}
	\email{leandro\_driguez@outlook.com}
		

\date{\today}

%\begin{abstract}
%	TODO...
%\end{abstract}

\bigskip
\maketitle


\bigskip
%%%%%%%%%%%%
%%%%%%%%%%%%
\section{Introduction}
\label{sec:intro}

TODO...


\section{Enunciado del Problema}
	
	\begin{prob}
		
		En un bar se controla la entrada de personas diaria durante una cantidad determinada de días. En lo adelante, la administración del bar se refiere a la cantidad de personas que entran, en relación a la media durante ese período, por ejemplo si un día entran $5$ personas más que la media calculada se registra como $5$, si entran $10$ personas menos que la media ya calculada se registra $-10$. Esta media no se actualiza. 
		
		La administración del bar tiene un registro de la asistencia durante $n$ días consecutivos, que ha sido registrada de la forma antes mencionada, y se ha visto que la asistencia al bar en la segunda mitad analizada fue la misma cada día.
		
		El dueño del bar va a hacerle una auditoría a la administración para saber si todo marcha bien. La auditor\'ia se lleva a cabo de la siguiente forma: El administrador le dirá un número $k$, y el dueño 
		obtendr\'a la suma de las $n - k + 1$ posibles secuencias de $k$ d\'ias consecutivos. Esto es, para todo $i$ entre $1$ y $n - k + 1$, obtendr\'a la suma:
		
		$$a_i + a_{i+1} + ... + a_{i+k-1}. $$
		
		Por ejemplo si se registr\'o como asistencia $[-1, 0, 1, 2, 2]$ (n\'otese que los dos \'ultimos elementos conforman la segunda mitad, tomando parte entera por debajo, y son todos iguales), para $k = 3$, el dueño tendrá como suma los números $0$, $3$ y $5$.
		
		Si todas las sumas obtenidas resultan positivas con respecto a la media anterior el dueño concluir\'a que el bar marcha bien, de lo contrario, despide al administrador.
		
		El administrador lo contrata a usted para que lo ayude, como científico que se considera, a determinar que  valor de $k$ debe elegir el administrador para que el due\~no del bar le no lo despida.
	\end{prob}

	\begin{prob}
		Se tiene una lista de $n$ n\'umeros enteros $a_1, a_2, \dots, a_n$. Se desea saber si existe un $1 \le k \le n$ tal que la suma
		\[ a_i + a_{i + 1} + \dots + a_{i + k - 1}\]
		es positiva para todo $1\le i\le n - k + 1$.
	\end{prob}

	\section{Soluci\'on Inocente}

	Como podemos ver una vez formulado el problema podemos encontrar una soluci\'on simplemente explorando todos el espacio de b\'usqueda. Veremos a continuaci\'on dicha soluci\'on.
	
	\begin{sol}\label{navy_sol}
		Podemos tomar cada entero positivo $1 \le k \le n$ y comprobar si para ese $k$ existe un subarray de tama\~no $k$, del dado, con suma no positiva, teniendo en caso contrario que $k$ es soluci\'on. Si $k$ no es soluci\'on para ning\'un valor entre $1$ y $n$, entonces la soluci\'on no existe y damos $-1$ como resultado.
		
		Para un $k$ fijado, podemos comprobar si este $k$ es soluci\'on haciendo todas las posibles sumas de $k$ valores consecutivos del array dado.
	\end{sol}

	\begin{prop}
		La soluci\'on dada en $\ref{navy_sol}$ es correcta.
	\end{prop}

	\begin{proof}
		Esto se puede ver directamente del hecho de que exploramos todas las sumas posibles de $k$ valores consecutivos para cada valor de $k$ posible.		
	\end{proof}

	\textbf{Complejidad temporal:} La complejidad temporal de esta soluci\'on es $\Theta(n^3)$. Tenemos $n$ valores posibles de $k$ a explorar, y para cada uno de ellos tenemos $n - k + 1$ subarrays de tama\~no $k$. Por tanto la cantidad de operaciones es del orden de 
	\begin{align}
		\sum_{k = 1}^n k(n - k + 1) &= \sum_{k = 1}^n kn - \sum_{k = 1}^n  (k^2 + k) = n^2(n + 1) / 2 - \sum_{k = 1}^n ( k^2 + k) 
		\\ &= n^2(n+1)/2 - n(n+1)(2n-1)/6 - n( n+ 1) / 2 
		\\ &= n^3(1/2 - 1/3) + n^2(1/2 - 1/6 - 1/2) + n(1/6 - 1/2) = \Theta(n^3).  
	\end{align}

	\textbf{Complejidad espacial:} Necesitaremos a lo sumo $2$ arreglos de taman\~no $n$ y algunos otros valores enteros, lo cual no es mas que $O(n)$ en complejidad espacial. 

	Sin embargo nos podemos quitar el factor $k$ de acumular el array de tama\~no $k$ si precalculamos en $O(n)$ la suma del prefijo de tama\~no $i$, para cada $1\le i \le n$. En este caso la soluci\'on ser\'ia entonces $\Theta(n^2)$.
	
	\section{Soluci\'on Propuesta}

		En esta secci\'on presentaremos una mejor soluci\'on del problema que la inocente. Adem\'as, demostraremos su correctitud y calcularemos su complejidad temporal. Finalmente demostraremos que es \'optima.
		
	\begin{sol}\label{sol_optima}
		Sea $a_1, a_2, \dots, a_n$ la lista dada. Si $a_n$ es no negativo, la soluci\'on es $n$ si $a_1 + \dots + a_n$ es positivo y $-1$ (no existe el $k$ buscado) en otro caso.
		
		Supongamos entonces que $a_n$ es negativo. Lo que hacemos es acumular para cada $1 \le i \le n$ el sufijo que comienza en $i$ de la lista dada, esto es $s_i := a_i + a_{i +1} + \dots + a_n$. Si $s_i$ es no positivo, descartamos como posibles valores de $k$, todos los n\'umeros entre $n - i + 1 - \min(\lfloor s_i/a_n \rfloor, \lfloor n/2 \rfloor)$ y $n - i + 1$. Luego si existe un $\lfloor n/2 \rfloor < k \le n$ que no haya sido descartado, este es la soluci\'on. En otro caso no existe la soluci\'on.
	\end{sol}

	
	\begin{teo}
		La Soluci\'on \ref{sol_optima} es correcta. 
	\end{teo}

	\begin{proof}
		Primero demostremos que si $k$ es soluci\'on, con $k \le \lfloor n/2 \rfloor $, entonces $2k$ tambi\'en. Supongamos por el contrario que existe un $1 \le i \le n - 2k + 1$ tal que $a_i + \dots + a_{i + 2k - 1} \le 0$. Entonces debe ocurrir que $a_i + \dots + a_{i + k - 1} \le 0$ o $a_{i + k} + \dots + a_i + 2k - 1 \le 0$, ya que de lo contrario la suma entera fuera positiva. Sin embargo ambas sumas est\'an compuestas por $k$ elementos consecutivos lo cual contradice que $k$ es soluci\'on. Por tanto si existe una soluci\'on entonces existe una tal que $k > \lfloor n/2 \rfloor$.
		
		Veamos que si $a_n \ge 0$ entonces existe una soluci\'on si y solo si $s_1 := a_1 + \dots + s_n > 0$. La implicaci\'on reversa es evidente. Supongamos entonces que existe una soluci\'on $k$. Entonces la suma $a_1 + a_2 + \dots + a_k > 0$. Dado que por el resultado anterior podemos asumir que $k > \lfloor n/2 \rfloor$, entonces $a_{k + 1} = a_{k + 2} = \dots = a_n \ge 0$. Por tanto $a_1 + a_2 + \dots + a_n = (a_1 + a_2 +\dots + a_k) + a_{k+1} + a_{k + 2} + \dots + a_n > 0 + (n - k)a_n \ge 0$, lo cual concluye nuestra demostraci\'on para este caso.
		
		Para el otro caso primero demostremos que si existe una $k > \lfloor n/2 \rfloor$ tal que $k$ no es soluci\'on, entonces $k$ fue descartado en la soluci\'on. Sea $i$ tal que $a_i + \dots + a_{i + k - 1} \le 0$. Veamos que
		\begin{align*}
			-\lfloor s_i/a_n \rfloor \le -s_i/a_n = -\frac{a_i + \dots + a_{i + k - 1} + a_{i + k} + \dots + a_n}{a_n} &\le - \frac{a_{i + k} + \dots + a_n}{a_n} \\ &= -\frac{(n - i - k + 1)a_n}{a_n}\\ &= (k + i - n - 1).
		\end{align*}
		Por tanto podemos ver que 
		\begin{align*}
		 l_i = \max( n - i + 1 - \lfloor s_i/a_n \rfloor, n - i  + 1 - \lfloor n/2 \rfloor) &\le \max(n- i + 1 + (k + i - n - 1), \lfloor n/2 \rfloor + 1) \\ &= \max(k, \lfloor n/2 \rfloor + 1)\le k,
		\end{align*}
		 y $r_i = (n - i + 1)$, de donde obtenemos $l_i \le k \le r_i$. Podemos decir entonces que este valor de $k$ fue correctamente descartado.
		
		Solo resta demostrar que si existe un valor de $k > \lfloor n/2 \rfloor$ que es soluci\'on, entonces este valor no es descartado por el algoritmo .Supongamos por el contrario que existe un $i$ tal que $l_i \le k \le r_i$. Veamos primero  que $i + l_i = i + n - i  + 1 - \min( \lfloor s_i/a_n \rfloor, \lfloor n/2 \rfloor) \ge n + 1 - \lfloor n/2 \rfloor > \lfloor n/2 \rfloor$ y por tanto $a_{i + l} = a_{i + l + 1} = \dots = a_n$.  Tenemos entonces que
		 \begin{align*}
		 a_i + a_{i + 1} + \dots + a_{ i + k - 1} =  s_i - (a_{i + k} + \dots + a_n) 
		 &\le s_i - (a_{i + l_i} + \dots + a_n) 
		 \\& = s_i - (n - l_i - i )a_n 
		 \\ & = s_i - \big (n - i - (n - i + 1 - \lfloor s_i / a_n \rfloor) \big)a_n
		 \\ & = s_i - (\lfloor s_i / a_n \rfloor - 1) a_n 
		   \le s_i 
		 \le 0, 
		 \end{align*}
	 
	de donde arribamos a una contradicci\'on, ya que existe un subarrray de tama\~no $k$ de suma no positiva.
 		
 		
 		%		 \begin{align*}
 			%			 &~&s_i \le& 0 \\
 			%			&\Rightarrow& s_i + a_{i + k} + \dots a_n \le& 0 \\
 			%			&\Rightarrow& s_i + a_n(n - i + 1 - k) \le& 0 \\
 			%			&\Rightarrow& s_i \le& -a_n(n - i + 1 - k) \\
 			%			&\Rightarrow& s_i/a_n \ge& -(n - i + 1 - k) \\
 			%			&\Rightarrow& s_i/a_n \ge& (k + i - n - 1) \\
 			%		 \end{align*}
 		
 		
 	\end{proof}
 		
		 \textbf{Complejidad temporal:}
		 
		 En el caso de que $a_n$ sea positivo solamente debemos acumular la lista, lo cual es $\Theta(n)$. En el otro caso, en cada iteraci\'on (cada valor de $i$ desde $1$ hasta $n - k + 1$) podemos hallar el valor de $s_i$ en $O(1)$ haciendo $s_{i} = s_{i - 1} + a_i$, donde $s_1$ se calcula en $\Theta(n)$ como en el caso anterior. 
		 
		 Sean $l_i$ y $r_i$ tales que en la iteraci\'on $i$ se determin\'o que debemos descartar como posibles valores de $k$ todos los enteros entre $l_i$ y $r_i$. Entonces creamos un array de tama\~no $n + 1$, inicialmente con todos los valores iguales a $0$. Luego por cada $i$, marcamos la posici\'on $l_i$ del array con valor $1$, y la posici\'on $r_i$ con valor $-1$. Luego pasamos acumulando el array desde la posici\'on $n/2$ hasta la $n$ y si en alg\'un momento la suma acumulada es $0$, entonces esa posici\'on corresponde a un valor que no fue descartado. Note que esto es similar al conocido \emph{factor de balance}. Note que en cada iteraci\'on $i$ se hacen un n\'umero constante de operaciones, lo cual representa una complejidad total de $\Theta(n)$ y luego pasar por el array del factor de balance es $\Theta(n)$ tambi\'en. Finalmente la complejidad temporal del algoritmo es $\Theta(n)$.
		 
		 \textbf{Complejidad espacial:} Necesitaremos a lo sumo $3$ arreglos de taman\~no $n$ y algunos otros valores enteros, lo cual no es mas que $O(n)$ en complejidad espacial. 
		 
		 
		 \medskip
		 Como resultado final de nuestro trabajo veremos que no existe una soluci\'on mejor al problema estudiado.
		 
		 \begin{teo}
		 	La complejidad de la Soluci\'on \ref{sol_optima} es \'optima.
		 \end{teo}
		 
		 \begin{proof}
		 	Para esto demostramos que para cualquier algoritmo de soluci\'on del problema, se debe realizar al menos una operaci\'on (aunque sea de lectura) con cada uno de los $n$ elementos. Suponga por el contrario que existe un algoritmo soluci\'on que ignora a alg\'un elemento de la lista, osea que puede dar una respuesta sin conocer el valor de una determinada posici\'on del array. Supongamos que la respuesta del algoritmo es $-1$ para una entrada determinada donde ignora el n\'umero en la posici\'on $i$. Esto significa que sin importar el valor de $a_i$ la soluci\'on seguir\'a siendo $-1$. Sin embargo, si $a_i > \big| \sum_{j \neq i} a_j \big|$, entonces $k = n$ es claramente una soluci\'on, lo cual es una contradicci\'on. Por tanto el algoritmo nunca podr\'a determinar cuando la soluci\'on es $-1$ sin analizar a todos los elementos del array, por tanto cualquier algoritmo que resuelva el problema tiene complejidad $\Omega(n)$, y por tanto la Soluci\'on \ref{sol_optima} es \'optima.
		 \end{proof}
		 
	
\medskip
%%%%%%%%%%%
%%%%%%%%%%%
%\section{Background}
%\label{sec:background}




%\newpage

%\bigskip
%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%
%\section{}





\bigskip
%%%%%%%%%%%%%%%
\begin{thebibliography}{20}
	
%	\bibitem{FT18} Y. Fan and S. Tringali: \emph{Power monoids: A bridge between factorization theory and arithmetic combinatorics}, J. Algebra \textbf{512} (2018) 252--294.

	%	\bibitem{GGT19} A. Geroldinger, F. Gotti, and S. Tringali: \emph{On strongly primary monoids, with a focus on Puiseux monoids}, J. Algebra \textbf{567} (2021) 310--345. 

%	\bibitem{GH06} A. Geroldinger and F. Halter-Koch: \emph{Non-unique Factorizations: Algebraic, Combinatorial and Analytic Theory}, Pure and Applied Mathematics Vol. 278, Chapman \& Hall/CRC, Boca Raton, 2006.

	%	\bibitem{mR93} M. Roitman: \emph{Polynomial extensions of atomic domains}, J. Pure Appl. Algebra \textbf{87} (1993) 187--199.
	
\end{thebibliography}


\end{document}
\@setaddresses